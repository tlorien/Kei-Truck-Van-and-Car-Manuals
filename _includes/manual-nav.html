{% assign manual_pages = site.pages | where: "layout", "manual" %}

{% assign filtered_pages = "" | split: "," %}
{% for p in manual_pages %}
  {% assign parts = p.path | split: "/" %}
  {% if parts[1] == page.brand and parts[2] == page.model and parts[3] == page.year and parts[4] == page.chassis %}
    {% assign filtered_pages = filtered_pages | push: p %}
  {% endif %}
{% endfor %}

{% assign sorted_pages = filtered_pages | sort: "path" %}

{% assign current_index = -1 %}
{% for p in sorted_pages %}
  {% if p.url == page.url %}
    {% assign current_index = forloop.index0 %}
  {% endif %}
{% endfor %}

<div class="manual-navigation">
  {% if current_index > 0 %}
    {% assign prev_page = sorted_pages[current_index | minus: 1] %}
    <a href="{{ prev_page.url | relative_url }}" class="prev">&larr; Previous: {{ prev_page.title }}</a>
  {% endif %}

  {% if current_index < sorted_pages.size | minus: 1 %}
    {% assign next_page = sorted_pages[current_index | plus: 1] %}
    <a href="{{ next_page.url | relative_url }}" class="next">Next: {{ next_page.title }} &rarr;</a>
  {% endif %}
</div>